<html>
<head>
	<meta http-equiv="content-type" content="text/html;charset=utf-8">
	<title>NP</title>
	<link rel="stylesheet" href="css/table.css" type="text/css" />
</style> 
</head>
<body>
	<table>
		<tr>
			<td>servent</td>
			<td colspan="3">
				<select id="servants"></select>
			</td>
			<td>query</td>
			<td colspan="3">
				<input type="text" id="search_str" width="60">
				<input type="button" id="search" onclick="search_name()" value="查询">
				<input type="button" id="reset" onclick="reset_list()" value="重置">
			</td>
		</tr>
		
		<tr>
			<td>card</td>
			<td colspan="7" id="cards"></td>
		</tr>
		
		<tr>
			<td>busterhits</td>
			<td><input type="text" id="busterhits" value="0" disabled></td>
			<td>artshits</td>
			<td><input type="text" id="artshits" value="0" disabled></td>
			<td>quickhits</td>
			<td><input type="text" id="quickhits" value="0" disabled></td>
			<td>exhits</td>
			<td><input type="text" id="exhits" value="0" disabled></td>
		</tr>
		
		<tr>
			<td>busternp</td>
			<td><input type="text" id="busternp" value="0" disabled></td>
			<td>artsnp</td>
			<td><input type="text" id="artsnp" value="0" disabled></td>
			<td>quicknp</td>
			<td><input type="text" id="quicknp" value="0" disabled></td>
			<td>exnp</td>
			<td><input type="text" id="exnp" value="0" disabled></td>
		</tr>
		
		<tr>
			<td>ride</td>
			<td><input type="text" id="ride" value="0" disabled></td>
			<td>artsbuild</td>
			<td><input type="text" id="craftbuild" value="0" disabled></td>
			<td colspan="4"></td>
		</tr>
		
		<tr>
			<td>npup</td>
			<td><input type="text" id="npup"></td>
			<td>artsup</td>
			<td><input type="text" id="artsup"></td>
			<td>quickup</td>
			<td><input type="text" id="quickup"></td>
			<td colspan="2"></td>
		</tr>
		
		<tr>
			<td colspan="8" height="50"></td>
		</tr>
		
		<tr>
			<td></td>
			<td>first</td>
			<td>second</td>
			<td>third</td>
			<td>ex</td>
			<td colspan="3"></td>
		</tr>
		
		<tr>
			<td>iscrit</td>
			<td><input type="checkbox" id="firstcrit" value="1"></td>
			<td><input type="checkbox" id="secondcrit" value="1"></td>
			<td><input type="checkbox" id="thirdcrit" value="1"></td>
			<td colspan="4"></td>
		</tr>

		<tr>
			<td >isoverkill</td>
			<td><input type="checkbox" id="firstok" value="1"></td>
			<td><input type="checkbox" id="secondok" value="1"></td>
			<td><input type="checkbox" id="thirdok" value="1"></td>
			<td><input type="checkbox" id="exok" value="1"></td>
			<td colspan="3"></td>
		</tr>
		
		<tr>
			<td>cardseq</td>
			<td>
				<select id="firstcard">
					<option value="0">None</option>
					<option value="1.0">Buster</option>
					<option value="2.0">Arts</option>
					<option value="1.5">Quick</option>
				</select>
			</td>
			<td>
				<select id="secondcard">
					<option value="0">None</option>
					<option value="1.0">Buster</option>
					<option value="2.0">Arts</option>
					<option value="1.5">Quick</option>
				</select>
			</td>
			<td>
				<select id="thirdcard">
					<option value="0">None</option>
					<option value="1.0">Buster</option>
					<option value="2.0">Arts</option>
					<option value="1.5">Quick</option>
				</select>
			</td>
			<td>
				<select id="excard">
					<option value="0">None</option>
					<option value="1.0">EX</option>
				</select>
			</td>
			<td colspan="3"></td>
		</tr>
		
		<tr>
			<td>enemy</td>
			<td>
				<select id="enemyclass">
					<option value="1">default</option>
					<option value="1">Saber</option>
					<option value="1">Archer</option>
					<option value="1">Lancer</option>
					<option value="1.1">Rider</option>
					<option value="1.2">Caster</option>
					<option value="0.9">Assassin</option>
					<option value="0.9">Berserker</option>
					<option value="1">Ruler</option>
					<option value="1">Avenger</option>
					<option value="1">Alter-ego</option>
					<option value="1">MoonCancer</option>
					<option value="1">Beast</option>
				</select>
			</td>
			<td>
				<select id="enemykind">
					<option value="1">default</option>
				</select>
			</td>
			<td colspan="5"></td>
		</tr>
	</table>
</body>
</html>

<script type="text/javascript" src="js/jquery-1.8.2.min.js"></script>
<script type="text/javascript">
	var $ = jQuery.noConflict();
	var servants = new Array();
	$(function(){  
		$.getJSON("data/servants.json",function(data){  
			$.each(data,function(infoIndex,info){
				servants[info["seq"]]=info;
				var lst='<option value="'+servants[info["seq"]].seq+'">'+servants[info["seq"]].id+servants[info["seq"]].class+":"+servants[info["seq"]].name+'</option>';
				$("#servants").append(lst);
			})
			$("#servants").val(1); 
			updateStatus(1);
		})
	});
	
	$("#servants").change(function(){
		var seq=$("#servants").val();
		updateStatus(seq);
	});
	
	function updateStatus(seq){
		$("#busterhits").val(servants[seq].BusterHits);
		$("#artshits").val(servants[seq].ArtsHits);
		$("#quickhits").val(servants[seq].QuickHits);
		$("#exhits").val(servants[seq].EXHits);
		$("#busternp").val(servants[seq].BusterNp);
		$("#artsnp").val(servants[seq].ArtsNp);
		$("#quicknp").val(servants[seq].QuickNp);
		$("#exnp").val(servants[seq].EXNp);
		$("#ride").val(servants[seq].QuickEff);
		$("#craftbuild").val(servants[seq].ArtsEff);
		$("#cards").empty();
		for(var i=0;i<servants[seq].BusterCards;i++){
			var card='<img src="http://fgowiki.com/wp-content/themes/umowang/images/Box/Buster.png" style="width:50">';
			$("#cards").append(card);
		}
		for(var i=0;i<servants[seq].ArtsCards;i++){
			var card='<img src="http://fgowiki.com/wp-content/themes/umowang/images/Box/Arts.png" style="width:50">';
			$("#cards").append(card);
		}
		for(var i=0;i<servants[seq].QuickCards;i++){
			var card='<img src="http://fgowiki.com/wp-content/themes/umowang/images/Box/Quick.png" style="width:50">';
			$("#cards").append(card);
		}
	};
	
	function search_name(){
		var str=$("#search_str").val();
		var flag=true;
		var sid=1;
		var lst='';
		for(var i in servants){
			if(servants[i].name.match(str)){
				if(flag){
					flag=false;
					sid=i;
				}
				lst+='<option value="'+servants[i].seq+'">'+servants[i].id+servants[i].class+":"+servants[i].name+'</option>';
			}
		}
		if(!flag){
			$("#servants").empty();
			$("#servants").append(lst);
			$("#servants").val(sid); 
			updateStatus(sid);
		}
		else{
			alert('未找到结果！');
		}
	};
	
	function reset_list(){
		$("#servants").empty();
		for(var i in servants){
			var lst='<option value="'+servants[i].seq+'">'+servants[i].id+servants[i].class+":"+servants[i].name+'</option>';
			$("#servants").append(lst);
		}
		$("#servants").val(1); 
		updateStatus(1);
	};
</script>